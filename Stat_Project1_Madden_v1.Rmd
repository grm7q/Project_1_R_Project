---
title: 'STAT 6021: Project 1'
author: "Greg Madden, Maxwell Levinson, Andrew Setaro, and Trey Hamilton"
date: "3/3/2022"
output: pdf_document
---

```{r setup, eval=FALSE, error = FALSE}
library(MASS)
library(tidyverse)
options(scipen = 999)
```

Reading in dataframe
```{r error = FALSE}
Data <- read_csv("diamonds4.csv")
```


```{r}

Data %>%
  select(cut) %>%
  unique()
```
Refactoring categorical variables
```{r}
#colnames(Data)
Data <- Data %>%
  #note VVS1 diamonds rank higher on the clarity scale than VVS2
  mutate(clarity = clarity%>%fct_relevel(c("FL", "IF", "VVS1","VVS2","VS1","VS2", "SI1", "SI2"))) %>%
  mutate(color = color%>%fct_relevel(c("D", "E", "F","G","H","I", "J"))) %>%
  mutate(cut = cut%>%fct_relevel(c("Good", "Very Good", "Ideal","Astor Ideal")))

# reordering so that price is first
Data <- Data[, c(5, 1, 2, 3, 4)]
```
Tasks: You have been approached by Blue Nile to perform the following tasks:

1. Use data visualizations to explore how price is related to the other variables (carat, clarity, color, cut), as well as how the other variables may relate to each other. 

```{r error = FALSE}
pairs(Data, lower.panel = NULL)
```

```{r}
library(viridis)
Data %>%
  ggplot(aes(x=carat, y = price, color = color)) +
  geom_point(alpha = 0.4) +
  labs(x="Carats", y="Price ($)", title = "Blue Nile Diamonds: Factors Influencing Price") +
  guides(color = guide_legend(title = "Color"), label.position = "right") +
    scale_color_viridis(discrete = TRUE, option = "A") +
  scale_fill_viridis(discrete = TRUE) +
   facet_wrap(~ cut + clarity)
```




Address the various claims on the diamond education page on Blue Nile.

* Cut: https://www.bluenile.com/education/diamonds/cut
  +"A diamond’s cut refers to how well-proportioned the dimensions of a diamond are, and how these surfaces, or facets, are positioned to create sparkle and brilliance. For example, what is the ratio of the diamond’s diameter in comparison to its depth? These small, yet essential, factors determine the diamond’s beauty and price."


2. Fit an appropriate simple linear regression for price against carat.

```{r error = FALSE}
result<-lm(price~ carat, data=Data)
summary(result)
```
```{r}
yhat<-result$fitted.values
res<-result$residuals
Data<-data.frame(Data,yhat,res)


ggplot(Data, aes(x=yhat,y=res))+
  geom_point()+
  geom_hline(yintercept=0, color="red")+
  labs(x="Fitted y", y="Residuals", title="Residual Plot")
```


```{r error = FALSE}

```




```{r error = FALSE}

```





```{r error = FALSE}

```






```{r error = FALSE}

```





```{r error = FALSE}

```





```{r error = FALSE}

```


