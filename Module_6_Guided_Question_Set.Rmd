---
title: "Module_6_Guided_Question_Set"
output: html_notebook
---



```{r}
library(MASS)
library(tidyverse)
```


Stat 6021: Guided Question Set 6
For this question, we will use the data set “nfl.txt”, which contains data on NFL team performance from the 1976 season. The variables are:
• y: Games won (14-game season)
• x1: Rushing yards (season)
• x2: Passing yards (season)
• x3: Punting average (yards/punt)
• x4: Field goal percentage (FGs made/FGs attempted)
• x5: Turnover differential (turnovers acquired - turnovers lost)
• x6: Penalty yards (season)
• x7: Percent rushing (rushing plays/total plays)
• x8: Opponents’ rushing yards (season)
• x9: Opponents’ passing yards (season)

1. Create a scatterplot matrix and find the correlation between all pairs of variables for this data set. Answer the following questions based on the output:


```{r}
Data<-read.table("nfl.txt", header=TRUE)

#pairs() creates a matrix of scatter plots (logical or factor columns are converted to numeric)
pairs(Data, lower.panel = NULL)
```
Correlations, looking just at the first row for correlations with y (Games won (14-game season))
```{r}
cor(Data)
#rcorr(as.matrix(Data))
```
(a) Which predictors appear to be linearly related to the number of wins? Which predictors do not appear to have a linear relationhsip with the number of wins?

x1, x2, x5, x7, and x8 all have R squared coefficients greater than .5

(b) Do you notice if any of the predictors are highly correlated with one another? If so, which ones?

X7 and x5 have an R squared of 0.610

(c) What predictors would you first consider to use in a multiplie linear regression? Briefly explain your choices.

since x7 and x5 seem correlated with each other and x7 has a higher R squred against the response, i'd use x1, x2, x7, and x8

2. Regardless of your answer to the previous question, fit a multiple regression model for the number of games won against the following three predictors: the team’s passing yardage, the percentage of rushing plays, and the opponents’ yards rushing. Write the estimated regression equation.

Estimated regression equation is: y=0.003598x2 + 0.193960x7 - 0.004816x8 - 1.808372
```{r}
##Fit MLR model, using + in between predictors
result<-lm(y~ x2 + x7 + x8, data=Data)
result
```

3. Interpret the estimated coefficient for the predictor x7 in context.

For each additional 1 percent rushing (plays/total plays), the number of expected games won will increase by 0.193960 when holding passing yards and opponents rushing yards constant. 


4. A team with x2 = 2000 yards, x7 = 48 percent, and x8 = 2350 yards would like to estimate the number of games it would win. Also provide a relevant interval for this estimate with 95% confidence.

```{r}
##Find CI for mean response and PI for a response for particular values of the predictors
newdata<-data.frame(x2=2000, x7=48, x8=2350)

predict(result, newdata, level=0.95, interval="prediction")

```

5. Using the output for the multiple linear regression model from part 2, answer the following question from a client: “Is this regression model useful in predicting the number of wins during the 1976 season?” Be sure to write the null and alternative hypotheses, state the value of the test statistic, state the p-value, and state a relevant conclusion. 

Yes this model is overall useful. Using the anova test  (hypotheses below) and given a p value less than 0.05, we can reject the null hypothesis and accept the alterative that the model is useful. F statistic is 29.44 on 3 and 24 DF, p value: 0.00000003273.

null: the model is not useful in predicting the response
alternative: he model is useful in predicting the response. 
```{r}
options(scipen=999)

summary(result)
```

What is the critical value associated with this hypothesis test? Perform the test at 0.05 significance level.

critical value is 3.72108

??what do you mean by 'perform the test'? 
??should I be dividing 0.05 by 2? 
```{r}

#follows the F-subscript(k, n-k-1) distribution
qf(1-0.05,3,24)
summary(result)

#?? do you use a two sided alpha (i.e. divide 0.05 by 2) for hypothesis tests regarding the coefficients? 
```

6. Report the value of the t statistic for the predictor x7. What is the relevant conclusion from this t statistic? Also report the critical value for this hypothesis test. Perform the test at 0.05 significance level.

t statistic is 2.064 and conclusion is that it cannot be dropped in the presence of the other predictors; it is needed in the presence of the other predictors given p value is <0.05. 

??should I be using bonferroni method here if not calculating the whole family of CIs? 
```{r}
#summary(result)
#follows the t-subscript(n-k-1) distribution
qt(1-0.05/2,24)
#bonferroni
#qt(1-0.05/3,3,24)
```


7. Check the regression assumptions by creating a residual plot, an ACF plot of the residuals, and a QQ plot of the residuals. Comment on these plots.


residuals are evenly distributed over x
```{r}
yhat<-result$fitted.values
res<-result$residuals
Data<-data.frame(Data,yhat,res)
library(tidyverse)
ggplot(Data, aes(x=yhat,y=res))+
  geom_point()+
  geom_hline(yintercept=0, color="red")+
  labs(x="Fitted y", y="Residuals", title="Residual Plot")
```

acf plot looks good
```{r}
acf(res,main="ACF Plot of Residuals")
```
qqplot looks generally normal 

```{r}
qqnorm(res)
qqline(res,col="red")
```


8. Consider adding another predictor, x1, the team’s rushing yards for the season, to the model. Interpret the results of the t test for the coefficient of this predictor. A classmate says: “Since the result of the t test is insignificant, the team’s rushing yards for the season is not linearly related to the number of wins.” Do you agree with your classmate’s statement?

No because the only way to answer that question would be to run a separate SLR. the t test for a MLR only says wherehter that predictor can be dropped in the presence of the other predictors. 
```{r}
result2<-lm(y~ x1 + x2 + x7 + x8, data=Data)
summary(result2)
```

